---
title: Preview Mode
excerpt: Configure preview mode for Drupal.
---

The Next Drupal module, paired with the `next-drupal` plugin, makes it easy to create [Next.js preview routes](https://nextjs.org/docs/advanced-features/preview-mode).

To configure preview mode for an entity type, you must configure a **Next.js site**, a **site resolver** for the entity type and a **OAuth Consumer**.

A _site resolver_ tells Drupal how to resolve the preview URL for an entity. Site resolvers are flexible, can handle multiple sites and work with _entity reference_ fields.

## Configure a Next.js site

Start by createing a new Next.js site.

- Visit _/admin/config/services/next_
- Click **Add Next.js site**
- Fill in the required information and click **Save**

## Configure a site resolver

Next, add a site resolver to your content type.

- Visit _/admin/config/services/next/entity-types_
- Click **Configure entity type**
- Select the entity type from the list
- Select a **Site resolver**
- Click **Save**

If you visit an entity page, you should be able to see the Next.js site preview. See the `next-drupal` plugin for more information on how to configure preview mode on the Next.js site.

## Configure OAuth Client

To generate preview routes, the Next.js client uses the [Client credentials grant](https://oauth2.thephpleague.com/authorization-server/client-credentials-grant/) for authentication. This is made possible using the (Simple OAuth)[https://www.drupal.org/project/simple_oauth] module.

### Create a Drupal role

- Create a new Drupal role (example `Next site`) by visiting _/admin/people/roles/add_
- Give the role the following permission:
  - Bypass content access control
  - View all revisions
  - View user information

### Create a user

Add a new user at _/admin/people/create_ and assign it the role created above.

_Note: When the Next.js is authenticated, it will be authenticated as this user._

### Configure a consumer

- Visit _/admin/config/people/simple_oauth_
- Click **Generate keys** to generate encryption keys for tokens
- Visit _/admin/config/services/consumer/add_
- Fill in a **Label**, **User** (select the user created above), **Secret** and under **Scopes**, select the role create above
- Click **Save**

_Important: note the client id (uuid) and the secret. This is going to be used as environment variables for the Next.js site._
